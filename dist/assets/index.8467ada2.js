import{d as I,a as f,v as R,o as A,b as m,c as h,e as i,t as L,u as c,F as _,S as U,r as k,p as C,f as T,g as p,h as N,i as O,j as w,k as M}from"./vendor.4b20aecb.js";const x=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerpolicy&&(s.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?s.credentials="include":t.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(t){if(t.ep)return;t.ep=!0;const s=r(t);fetch(t.href,s)}};x();const P="user",D=I(P,{state:()=>({profile:null,error:null,numberOfLoginTries:0}),actions:{readUserProfile(){return this.loading=!0,f.get("https://api.spotify.com/v1/me").then(o=>{this.profile=o.data}).finally(()=>{this.numberOfLoginTries++,this.loading=!1})}}}),$="1ab55d460fa4444ea2bde381750d3432",B="user-read-private user-read-email user-library-modify user-library-read playlist-modify-private playlist-read-collaborative playlist-read-private playlist-modify-public",F="https://localhost:3000/loginRedirect",g="spotifyAccessToken",y="stateTokenForLogin",d=()=>{const o=location.hash?encodeURI(location.hash):R().substring(0,16);localStorage.setItem(y,o);let e="https://accounts.spotify.com/authorize";e+="?response_type=token",e+="&client_id="+encodeURIComponent($),e+="&scope="+encodeURIComponent(B),e+="&redirect_uri="+encodeURIComponent(F),e+="&state="+encodeURIComponent(o),window.location=e},b=()=>{const o=localStorage.getItem(g);f.defaults.headers.Authorization=o?`Bearer ${o}`:void 0},V=()=>new Promise((o,e)=>{let r=location.hash;r.startsWith("#")&&(r=r.substring(1));const n=r.split("&").reduce((u,v)=>{const[S,E]=v.split("=");return u[S]=E,u},{}),{access_token:t,state:s}=n,a=localStorage.getItem(y);s!==a&&e(new Error("State passt nicht",{state:s,expectedState:a})),localStorage.setItem(g,t),b(),o(!0)});b();const G=i("h1",null,"Spotify Connect",-1),z=i("hr",null,null,-1),H={setup(o){const e=D();return A(()=>{e.readUserProfile().catch(r=>{console.error(r);debugger;d()})}),(r,n)=>(m(),h(_,null,[G,i("pre",null,L(c(e)),1),z,i("button",{type:"button",onClick:n[0]||(n[0]=t=>c(d)())},"Anmelden"),i("button",{type:"button",onClick:n[1]||(n[1]=t=>c(e).readUserProfile())},"User-Informationen lesen")],64))}},K={setup(o){const e=new U,r=k({test:"testinhalt",spotifyApi:e});return C("appData",r),(n,t)=>{const s=T("router-view");return m(),h(_,null,[p(H),p(s)],64)}}};var W=(o,e)=>{const r=o.__vccOpts||o;for(const[n,t]of e)r[n]=t;return r};const j={};function q(o,e){return" hallo Vue "}var J=W(j,[["render",q]]);const Q="LoginRedirect",X=[{path:"/",name:"home",component:J},{path:"/loginRedirect",name:Q,beforeEnter(o,e,r){V().then(n=>console.log("Route-Guard fertig")).catch(n=>{console.error(n),alert(n.message)}).finally(()=>r("/"))}}];var Y=N({history:O(),routes:X});const l=w(K);l.use(Y);l.use(M());l.mount("#app");
